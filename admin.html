<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BioLink Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1f2937; /* Dark blue-gray background */
            color: #e5e7eb; /* Light gray text */
        }
        .admin-section {
            background-color: #374151; /* Medium gray card background */
            border-radius: 0.5rem; /* rounded-lg */
            padding: 1.5rem; /* p-6 */
            margin-bottom: 1.5rem; /* mb-6 */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .admin-section h2 {
            font-size: 1.5rem; /* text-2xl */
            font-weight: 600; /* font-semibold */
            margin-bottom: 1rem; /* mb-4 */
            border-bottom: 1px solid #4b5563; /* border-gray-600 */
            padding-bottom: 0.5rem; /* pb-2 */
        }
        label {
            display: block;
            margin-bottom: 0.5rem; /* mb-2 */
            font-weight: 500; /* font-medium */
            color: #d1d5db; /* text-gray-300 */
        }
        input[type="text"],
        input[type="url"],
        input[type="color"],
        textarea,
        select {
            width: 100%;
            padding: 0.75rem; /* p-3 */
            border-radius: 0.375rem; /* rounded-md */
            background-color: #4b5563; /* bg-gray-600 */
            border: 1px solid #6b7280; /* border-gray-500 */
            color: #e5e7eb; /* text-gray-100 */
            margin-bottom: 1rem; /* mb-4 */
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        input[type="text"]:focus,
        input[type="url"]:focus,
        input[type="color"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #60a5fa; /* border-blue-400 */
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.3);
        }
        input[type="checkbox"] {
            margin-right: 0.5rem;
            accent-color: #60a5fa; /* blue-400 */
        }
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.375rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
        }
        .btn-primary {
            background-color: #3b82f6; /* bg-blue-600 */
            color: white;
        }
        .btn-primary:hover {
            background-color: #2563eb; /* bg-blue-700 */
        }
        .btn-secondary {
            background-color: #6b7280; /* bg-gray-500 */
            color: white;
        }
        .btn-secondary:hover {
            background-color: #4b5563; /* bg-gray-600 */
        }
        .btn-danger {
            background-color: #ef4444; /* bg-red-500 */
            color: white;
        }
        .btn-danger:hover {
            background-color: #dc2626; /* bg-red-600 */
        }
        #generatedJsonOutput {
            white-space: pre-wrap;
            word-break: break-all;
            font-family: monospace;
            min-height: 200px;
        }
        .link-item {
            border: 1px solid #4b5563;
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 0.375rem;
        }
        .link-item h3 {
            font-size: 1.125rem; /* text-lg */
            font-weight: 500;
            margin-bottom: 0.75rem;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-4xl mx-auto">
        <header class="mb-8 text-center">
            <h1 class="text-4xl font-bold text-white">BioLink Customization Panel</h1>
            <p class="text-lg text-gray-400">Modify your BioLink page settings below.</p>
        </header>

        <div class="mb-6 text-center">
            <button id="loadConfigBtn" class="btn btn-secondary"><i class="fas fa-cloud-download-alt mr-2"></i>Load Existing Config from config.json</button>
            <p class="text-xs text-gray-500 mt-1">Assumes 'config.json' is in the same directory or accessible via root path.</p>
        </div>

        <section class="admin-section" id="profileSettings">
            <h2><i class="fas fa-user-circle mr-2"></i>Profile Settings</h2>
            <div>
                <label for="profileName">Profile Name:</label>
                <input type="text" id="profileName" name="profileName">
            </div>
            <div>
                <label for="profileBio">Profile Bio:</label>
                <textarea id="profileBio" name="profileBio" rows="3"></textarea>
            </div>
            <div>
                <label for="profilePictureUrl">Profile Picture URL:</label>
                <input type="url" id="profilePictureUrl" name="profilePictureUrl">
            </div>
            <div>
                <label for="footerName">Footer Name:</label>
                <input type="text" id="footerName" name="footerName">
            </div>
        </section>

        <section class="admin-section" id="appearanceSettings">
            <h2><i class="fas fa-paint-brush mr-2"></i>Appearance Settings</h2>
            <div>
                <label for="backgroundImageUrl">Background Image URL:</label>
                <input type="url" id="backgroundImageUrl" name="backgroundImageUrl">
            </div>
            <h3 class="text-lg font-semibold mt-6 mb-2 text-gray-200">Card Styling</h3>
            <div>
                <label for="cardBackgroundColor">Card Background Color (rgba format recommended for transparency, e.g., rgba(0,0,0,0.5)):</label>
                <input type="text" id="cardBackgroundColor" name="cardBackgroundColor" placeholder="rgba(20, 20, 20, 0.75)">
            </div>
            <div>
                <label for="cardTextColor">Card Text Color (Hex, e.g., #E5E7EB):</label>
                <input type="color" id="cardTextColor" name="cardTextColor" value="#E5E7EB">
            </div>
            <div>
                <label for="cardBorderColor">Card Border Color (rgba or hex, e.g., rgba(255,255,255,0.2)):</label>
                <input type="text" id="cardBorderColor" name="cardBorderColor" placeholder="rgba(255, 255, 255, 0.2)">
            </div>
            <div>
                <label for="cardBorderRadius">Card Border Radius (Tailwind class, e.g., rounded-xl, rounded-2xl):</label>
                <input type="text" id="cardBorderRadius" name="cardBorderRadius" placeholder="rounded-xl">
            </div>

            <h3 class="text-lg font-semibold mt-6 mb-2 text-gray-200">Profile Text Styling</h3>
             <div>
                <label for="profileNameColor">Profile Name Color (Hex):</label>
                <input type="color" id="profileNameColor" name="profileNameColor" value="#FFFFFF">
            </div>
            <div>
                <label for="profileBioColor">Profile Bio Color (Hex):</label>
                <input type="color" id="profileBioColor" name="profileBioColor" value="#D1D5DB">
            </div>
        </section>

        <section class="admin-section" id="linksSettings">
            <h2><i class="fas fa-link mr-2"></i>Links</h2>
            <div id="linksListContainer">
                </div>
            <button id="addLinkBtn" class="btn btn-secondary mt-4"><i class="fas fa-plus mr-2"></i>Add New Link</button>
        </section>

        <section class="admin-section mt-8">
            <h2><i class="fas fa-cogs mr-2"></i>Generate Configuration</h2>
            <button id="generateConfigBtn" class="btn btn-primary w-full text-lg"><i class="fas fa-file-code mr-2"></i>Generate New config.json</button>
            <div class="mt-4">
                <label for="generatedJsonOutput">Generated JSON (Copy this and paste into your config.json file):</label>
                <textarea id="generatedJsonOutput" rows="15" readonly class="bg-gray-700 border-gray-600 text-gray-200"></textarea>
            </div>
        </section>

        <footer class="text-center text-gray-500 mt-12 pb-8">
            <p>BioLink Admin Panel v1.0</p>
        </footer>
    </div>

    <script>
        // --- DOM Elements ---
        const profileNameInput = document.getElementById('profileName');
        const profileBioInput = document.getElementById('profileBio');
        const profilePictureUrlInput = document.getElementById('profilePictureUrl');
        const footerNameInput = document.getElementById('footerName');

        const backgroundImageUrlInput = document.getElementById('backgroundImageUrl');
        const cardBackgroundColorInput = document.getElementById('cardBackgroundColor');
        const cardTextColorInput = document.getElementById('cardTextColor');
        const cardBorderColorInput = document.getElementById('cardBorderColor');
        const cardBorderRadiusInput = document.getElementById('cardBorderRadius');
        const profileNameColorInput = document.getElementById('profileNameColor');
        const profileBioColorInput = document.getElementById('profileBioColor');

        const linksListContainer = document.getElementById('linksListContainer');
        const addLinkBtn = document.getElementById('addLinkBtn');
        const generateConfigBtn = document.getElementById('generateConfigBtn');
        const loadConfigBtn = document.getElementById('loadConfigBtn');
        const generatedJsonOutput = document.getElementById('generatedJsonOutput');

        let linksData = []; // To store link objects

        // --- Load Config ---
        loadConfigBtn.addEventListener('click', async () => {
            try {
                const response = await fetch('config.json?t=' + new Date().getTime()); // Cache buster
                if (!response.ok) {
                    throw new Error(`Failed to fetch config.json: ${response.status} ${response.statusText}`);
                }
                const config = await response.json();
                populateForm(config);
                alert('Configuration loaded successfully!');
            } catch (error) {
                console.error('Error loading config.json:', error);
                alert(`Error loading config.json: ${error.message}. Make sure the file exists and is valid JSON.`);
                // Optionally, load with default/empty values or clear form
                populateForm(createDefaultConfig()); // Populate with defaults on error
            }
        });

        function createDefaultConfig() {
            return {
                profile: { name: "", bio: "", pictureUrl: "", footerName: "" },
                appearance: {
                    backgroundImageUrl: "",
                    card: { backgroundColor: "rgba(20, 20, 20, 0.75)", textColor: "#E5E7EB", borderColor: "rgba(255, 255, 255, 0.2)", borderRadius: "rounded-xl" },
                    profileText: { nameColor: "#FFFFFF", bioColor: "#D1D5DB" }
                },
                links: []
            };
        }

        function populateForm(config) {
            const profile = config.profile || {};
            profileNameInput.value = profile.name || '';
            profileBioInput.value = profile.bio || '';
            profilePictureUrlInput.value = profile.pictureUrl || '';
            footerNameInput.value = profile.footerName || profile.name || '';

            const appearance = config.appearance || {};
            backgroundImageUrlInput.value = appearance.backgroundImageUrl || '';

            const card = appearance.card || {};
            cardBackgroundColorInput.value = card.backgroundColor || 'rgba(20, 20, 20, 0.75)';
            cardTextColorInput.value = card.textColor || '#E5E7EB';
            cardBorderColorInput.value = card.borderColor || 'rgba(255, 255, 255, 0.2)';
            cardBorderRadiusInput.value = card.borderRadius || 'rounded-xl';

            const profileText = appearance.profileText || {};
            profileNameColorInput.value = profileText.nameColor || '#FFFFFF';
            profileBioColorInput.value = profileText.bioColor || '#D1D5DB';

            linksData = config.links || [];
            renderLinksUI();
        }

        // --- Links Management ---
        function renderLinksUI() {
            linksListContainer.innerHTML = ''; // Clear existing links
            linksData.forEach((link, index) => {
                const linkItemDiv = document.createElement('div');
                linkItemDiv.className = 'link-item';
                linkItemDiv.innerHTML = `
                    <h3>Link ${index + 1}</h3>
                    <div>
                        <label for="linkText-${index}">Text:</label>
                        <input type="text" id="linkText-${index}" value="${link.text || ''}" class="link-input-text">
                    </div>
                    <div>
                        <label for="linkUrl-${index}">URL:</label>
                        <input type="url" id="linkUrl-${index}" value="${link.url || ''}" class="link-input-url">
                    </div>
                    <div>
                        <label for="linkIcon-${index}">Icon (Font Awesome classes, e.g., fas fa-globe):</label>
                        <input type="text" id="linkIcon-${index}" value="${link.icon || ''}" class="link-input-icon">
                    </div>
                    <div>
                        <label for="linkClasses-${index}">Styling Classes (Tailwind, e.g., bg-blue-500 hover:bg-blue-600 text-white):</label>
                        <input type="text" id="linkClasses-${index}" value="${link.classes || ''}" class="link-input-classes">
                    </div>
                    <div>
                        <label for="linkEnabled-${index}">Enabled:</label>
                        <input type="checkbox" id="linkEnabled-${index}" ${link.enabled ? 'checked' : ''} class="link-input-enabled">
                    </div>
                    <button class="btn btn-danger btn-sm mt-2 remove-link-btn" data-index="${index}"><i class="fas fa-trash-alt mr-1"></i>Remove Link</button>
                `;
                linksListContainer.appendChild(linkItemDiv);
            });

            // Add event listeners for remove buttons
            document.querySelectorAll('.remove-link-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const indexToRemove = parseInt(e.currentTarget.dataset.index);
                    linksData.splice(indexToRemove, 1);
                    renderLinksUI(); // Re-render the links list
                });
            });
        }

        addLinkBtn.addEventListener('click', () => {
            linksData.push({
                id: `link_${new Date().getTime()}`, // Simple unique ID
                text: "New Link",
                url: "#",
                icon: "fas fa-link",
                enabled: true,
                classes: "bg-gray-500 hover:bg-gray-600 text-white"
            });
            renderLinksUI();
        });


        // --- Generate Config ---
        generateConfigBtn.addEventListener('click', () => {
            // Update linksData from UI before generating
            const linkItems = linksListContainer.querySelectorAll('.link-item');
            const updatedLinksData = [];
            linkItems.forEach((item, index) => { // Use index to ensure order is maintained
                const id = linksData[index] ? linksData[index].id : `new_link_${new Date().getTime()}_${index}`; // Keep existing ID or generate new
                updatedLinksData.push({
                    id: id,
                    text: item.querySelector('.link-input-text').value,
                    url: item.querySelector('.link-input-url').value,
                    icon: item.querySelector('.link-input-icon').value,
                    classes: item.querySelector('.link-input-classes').value,
                    enabled: item.querySelector('.link-input-enabled').checked
                });
            });
            linksData = updatedLinksData; // Update the main linksData array

            const newConfig = {
                profile: {
                    name: profileNameInput.value,
                    bio: profileBioInput.value,
                    pictureUrl: profilePictureUrlInput.value,
                    footerName: footerNameInput.value
                },
                appearance: {
                    backgroundImageUrl: backgroundImageUrlInput.value,
                    card: {
                        backgroundColor: cardBackgroundColorInput.value,
                        textColor: cardTextColorInput.value,
                        borderColor: cardBorderColorInput.value,
                        borderRadius: cardBorderRadiusInput.value
                    },
                    profileText: {
                        nameColor: profileNameColorInput.value,
                        bioColor: profileBioColorInput.value
                    }
                },
                links: linksData
            };

            generatedJsonOutput.value = JSON.stringify(newConfig, null, 2); // Pretty print JSON
            alert('Configuration generated! Copy the JSON below and save it as config.json in your site\'s root directory.');
        });

        // --- Initial Load (optional, or prompt user) ---
        // Uncomment to attempt loading config on page load
        // document.addEventListener('DOMContentLoaded', () => loadConfigBtn.click());
        // Or, populate with default empty state initially
        populateForm(createDefaultConfig());

    </script>
</body>
</html>
